"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/watchlist";
exports.ids = ["pages/api/watchlist"];
exports.modules = {

/***/ "(api-node)/./lib/supabaseClient.js":
/*!*******************************!*\
  !*** ./lib/supabaseClient.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst supabaseUrl = \"https://skzkjdmrbunngwfsqxry.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNremtqZG1yYnVubmd3ZnNxeHJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MjIxOTUsImV4cCI6MjA2MjE5ODE5NX0.o_yGO3xrofyDT7W7qELePQyqiOOx_1rQm2xHg44pUZA\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9zdXBhYmFzZUNsaWVudC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBb0Q7QUFFcEQsTUFBTUMsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO0FBRTFELE1BQU1LLFdBQVdQLG1FQUFZQSxDQUFDQyxhQUFhSSxpQkFBZ0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xca2FydGhcXE9uZURyaXZlXFxEZXNrdG9wXFxiYlxcbGliXFxzdXBhYmFzZUNsaWVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXHJcblxyXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTFxyXG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWVxyXG5cclxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpXHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./lib/supabaseClient.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fwatchlist&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cwatchlist.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fwatchlist&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cwatchlist.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_watchlist_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\watchlist.js */ \"(api-node)/./pages/api/watchlist.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_watchlist_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_watchlist_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/watchlist\",\n        pathname: \"/api/watchlist\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_watchlist_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGd2F0Y2hsaXN0JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUN3YXRjaGxpc3QuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDdUQ7QUFDdkQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLG9EQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxvREFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFx3YXRjaGxpc3QuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3dhdGNobGlzdFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3dhdGNobGlzdFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fwatchlist&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cwatchlist.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/watchlist.js":
/*!********************************!*\
  !*** ./pages/api/watchlist.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/supabaseClient */ \"(api-node)/./lib/supabaseClient.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"next-auth/jwt\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst secret = process.env.NEXTAUTH_SECRET;\nasync function handler(req, res) {\n    try {\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req,\n            secret\n        });\n        console.log(\"Token extracted:\", token);\n        if (!token) {\n            console.error(\"Unauthorized: No valid token found\");\n            return res.status(401).json({\n                error: \"Unauthorized: No valid token found\"\n            });\n        }\n        console.log(\"Full token:\", token);\n        // Try to get user ID from token.sub or token.user_id or token.id\n        const userId = token.sub || token.user_id || token.id;\n        console.log(\"User ID from token:\", userId, \"Type:\", typeof userId);\n        if (!userId) {\n            console.error(\"Unauthorized: User ID not found in token\");\n            return res.status(401).json({\n                error: \"Unauthorized: User ID not found\"\n            });\n        }\n        // Check if userId is a valid UUID string (basic check)\n        const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n        if (!uuidRegex.test(userId)) {\n            console.warn(\"Warning: userId does not appear to be a valid UUID:\", userId);\n        }\n        if (req.method === \"GET\") {\n            const { data, error } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"watchlist\").select(\"*\").eq(\"user_id\", userId);\n            if (error) {\n                console.error(\"Error fetching watchlist:\", error);\n                return res.status(500).json({\n                    error: error.message\n                });\n            }\n            return res.status(200).json(data);\n        }\n        if (req.method === \"POST\") {\n            try {\n                const { anime_id, status, comment, image_url } = req.body;\n                console.log(\"POST /api/watchlist body:\", req.body);\n                if (!anime_id || !status) {\n                    console.error(\"Bad request: Missing anime_id or status\");\n                    return res.status(400).json({\n                        error: \"anime_id and status are required\"\n                    });\n                }\n                const { data: existing, error: fetchError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"watchlist\").select(\"*\").eq(\"user_id\", userId).eq(\"anime_id\", anime_id).maybeSingle();\n                if (fetchError) {\n                    console.error(\"Error checking existing watchlist entry:\", fetchError);\n                    return res.status(500).json({\n                        error: fetchError.message,\n                        details: fetchError\n                    });\n                }\n                if (existing) {\n                    const { data, error } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"watchlist\").update({\n                        status,\n                        comment,\n                        image_url,\n                        updated_at: new Date().toISOString()\n                    }).eq(\"id\", existing.id).select();\n                    if (error) {\n                        console.error(\"Error updating watchlist entry:\", error);\n                        return res.status(500).json({\n                            error: error.message,\n                            details: error\n                        });\n                    }\n                    return res.status(200).json(data);\n                } else {\n                    const { data, error } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"watchlist\").insert([\n                        {\n                            user_id: userId,\n                            anime_id,\n                            status,\n                            comment,\n                            image_url\n                        }\n                    ]).select();\n                    if (error) {\n                        console.error(\"Error inserting watchlist entry:\", error);\n                        return res.status(500).json({\n                            error: error.message,\n                            details: error\n                        });\n                    }\n                    return res.status(201).json(data);\n                }\n            } catch (err) {\n                console.error(\"Unexpected error in POST /api/watchlist:\", err);\n                return res.status(500).json({\n                    error: \"Unexpected server error\",\n                    details: err.message || err\n                });\n            }\n        }\n        if (req.method === \"DELETE\") {\n            const { anime_id } = req.body;\n            if (!anime_id) {\n                console.error(\"Bad request: Missing anime_id for deletion\");\n                return res.status(400).json({\n                    error: \"anime_id is required for deletion\"\n                });\n            }\n            const { data, error } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"watchlist\").delete().eq(\"user_id\", userId).eq(\"anime_id\", anime_id);\n            if (error) {\n                console.error(\"Error deleting watchlist entry:\", error);\n                return res.status(500).json({\n                    error: error.message\n                });\n            }\n            return res.status(200).json({\n                message: \"Watchlist entry deleted\",\n                data\n            });\n        }\n        res.setHeader(\"Allow\", [\n            \"GET\",\n            \"POST\",\n            \"DELETE\"\n        ]);\n        return res.status(405).end(`Method ${req.method} Not Allowed`);\n    } catch (err) {\n        console.error(\"Unexpected server error:\", err);\n        return res.status(500).json({\n            error: \"Unexpected server error\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YmxCLFFBQVFFLEtBQUssQ0FBQztnQkFDZCxPQUFPSixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFRixPQUFPO2dCQUFvQztZQUMzRTtZQUVBLE1BQU0sRUFBRVcsSUFBSSxFQUFFWCxLQUFLLEVBQUUsR0FBRyxNQUFNWix5REFBUUEsQ0FDbkN3QixJQUFJLENBQUMsYUFDTGtCLE1BQU0sR0FDTmhCLEVBQUUsQ0FBQyxXQUFXWCxRQUNkVyxFQUFFLENBQUMsWUFBWUU7WUFFbEIsSUFBSWhCLE9BQU87Z0JBQ1RGLFFBQVFFLEtBQUssQ0FBQyxtQ0FBbUNBO2dCQUNqRCxPQUFPSixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFRixPQUFPQSxNQUFNZSxPQUFPO2dCQUFDO1lBQ3JEO1lBRUEsT0FBT25CLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVhLFNBQVM7Z0JBQTJCSjtZQUFLO1FBQ3pFO1FBRUFmLElBQUltQyxTQUFTLENBQUMsU0FBUztZQUFDO1lBQU87WUFBUTtTQUFTO1FBQ2hELE9BQU9uQyxJQUFJSyxNQUFNLENBQUMsS0FBSytCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRXJDLElBQUllLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDL0QsRUFBRSxPQUFPbUIsS0FBSztRQUNaL0IsUUFBUUUsS0FBSyxDQUFDLDRCQUE0QjZCO1FBQzFDLE9BQU9qQyxJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVGLE9BQU87UUFBMEI7SUFDakU7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxrYXJ0aFxcT25lRHJpdmVcXERlc2t0b3BcXGJiXFxwYWdlc1xcYXBpXFx3YXRjaGxpc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLi4vLi4vbGliL3N1cGFiYXNlQ2xpZW50XCI7XHJcbmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSBcIm5leHQtYXV0aC9qd3RcIjtcclxuXHJcbmNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVDtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZXRUb2tlbih7IHJlcSwgc2VjcmV0IH0pO1xyXG4gICAgY29uc29sZS5sb2coXCJUb2tlbiBleHRyYWN0ZWQ6XCIsIHRva2VuKTtcclxuXHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmF1dGhvcml6ZWQ6IE5vIHZhbGlkIHRva2VuIGZvdW5kXCIpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWQ6IE5vIHZhbGlkIHRva2VuIGZvdW5kXCIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coXCJGdWxsIHRva2VuOlwiLCB0b2tlbik7XHJcbiAgICAvLyBUcnkgdG8gZ2V0IHVzZXIgSUQgZnJvbSB0b2tlbi5zdWIgb3IgdG9rZW4udXNlcl9pZCBvciB0b2tlbi5pZFxyXG4gICAgY29uc3QgdXNlcklkID0gdG9rZW4uc3ViIHx8IHRva2VuLnVzZXJfaWQgfHwgdG9rZW4uaWQ7XHJcbiAgICBjb25zb2xlLmxvZyhcIlVzZXIgSUQgZnJvbSB0b2tlbjpcIiwgdXNlcklkLCBcIlR5cGU6XCIsIHR5cGVvZiB1c2VySWQpO1xyXG5cclxuICAgIGlmICghdXNlcklkKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmF1dGhvcml6ZWQ6IFVzZXIgSUQgbm90IGZvdW5kIGluIHRva2VuXCIpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWQ6IFVzZXIgSUQgbm90IGZvdW5kXCIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgdXNlcklkIGlzIGEgdmFsaWQgVVVJRCBzdHJpbmcgKGJhc2ljIGNoZWNrKVxyXG4gICAgY29uc3QgdXVpZFJlZ2V4ID0gL15bMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMS01XVswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfSQvaTtcclxuICAgIGlmICghdXVpZFJlZ2V4LnRlc3QodXNlcklkKSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJXYXJuaW5nOiB1c2VySWQgZG9lcyBub3QgYXBwZWFyIHRvIGJlIGEgdmFsaWQgVVVJRDpcIiwgdXNlcklkKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJHRVRcIikge1xyXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKFwid2F0Y2hsaXN0XCIpXHJcbiAgICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgd2F0Y2hsaXN0OlwiLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB7IGFuaW1lX2lkLCBzdGF0dXMsIGNvbW1lbnQsIGltYWdlX3VybCB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUE9TVCAvYXBpL3dhdGNobGlzdCBib2R5OlwiLCByZXEuYm9keSk7XHJcblxyXG4gICAgICAgIGlmICghYW5pbWVfaWQgfHwgIXN0YXR1cykge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkJhZCByZXF1ZXN0OiBNaXNzaW5nIGFuaW1lX2lkIG9yIHN0YXR1c1wiKTtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcImFuaW1lX2lkIGFuZCBzdGF0dXMgYXJlIHJlcXVpcmVkXCIgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKFwid2F0Y2hsaXN0XCIpXHJcbiAgICAgICAgICAuc2VsZWN0KFwiKlwiKVxyXG4gICAgICAgICAgLmVxKFwidXNlcl9pZFwiLCB1c2VySWQpXHJcbiAgICAgICAgICAuZXEoXCJhbmltZV9pZFwiLCBhbmltZV9pZClcclxuICAgICAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgICAgICBpZiAoZmV0Y2hFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNoZWNraW5nIGV4aXN0aW5nIHdhdGNobGlzdCBlbnRyeTpcIiwgZmV0Y2hFcnJvcik7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZmV0Y2hFcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBmZXRjaEVycm9yIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbShcIndhdGNobGlzdFwiKVxyXG4gICAgICAgICAgICAudXBkYXRlKHsgc3RhdHVzLCBjb21tZW50LCBpbWFnZV91cmwsIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KVxyXG4gICAgICAgICAgICAuZXEoXCJpZFwiLCBleGlzdGluZy5pZClcclxuICAgICAgICAgICAgLnNlbGVjdCgpO1xyXG5cclxuICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgd2F0Y2hsaXN0IGVudHJ5OlwiLCBlcnJvcik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKFwid2F0Y2hsaXN0XCIpXHJcbiAgICAgICAgICAgIC5pbnNlcnQoW3sgdXNlcl9pZDogdXNlcklkLCBhbmltZV9pZCwgc3RhdHVzLCBjb21tZW50LCBpbWFnZV91cmwgfV0pXHJcbiAgICAgICAgICAgIC5zZWxlY3QoKTtcclxuXHJcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluc2VydGluZyB3YXRjaGxpc3QgZW50cnk6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UsIGRldGFpbHM6IGVycm9yIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbihkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmV4cGVjdGVkIGVycm9yIGluIFBPU1QgL2FwaS93YXRjaGxpc3Q6XCIsIGVycik7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiVW5leHBlY3RlZCBzZXJ2ZXIgZXJyb3JcIiwgZGV0YWlsczogZXJyLm1lc3NhZ2UgfHwgZXJyIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlcS5tZXRob2QgPT09IFwiREVMRVRFXCIpIHtcclxuICAgICAgY29uc3QgeyBhbmltZV9pZCB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgICBpZiAoIWFuaW1lX2lkKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkJhZCByZXF1ZXN0OiBNaXNzaW5nIGFuaW1lX2lkIGZvciBkZWxldGlvblwiKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJhbmltZV9pZCBpcyByZXF1aXJlZCBmb3IgZGVsZXRpb25cIiB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbShcIndhdGNobGlzdFwiKVxyXG4gICAgICAgIC5kZWxldGUoKVxyXG4gICAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAgIC5lcShcImFuaW1lX2lkXCIsIGFuaW1lX2lkKTtcclxuXHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyB3YXRjaGxpc3QgZW50cnk6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogXCJXYXRjaGxpc3QgZW50cnkgZGVsZXRlZFwiLCBkYXRhIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5zZXRIZWFkZXIoXCJBbGxvd1wiLCBbXCJHRVRcIiwgXCJQT1NUXCIsIFwiREVMRVRFXCJdKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHtyZXEubWV0aG9kfSBOb3QgQWxsb3dlZGApO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIlVuZXhwZWN0ZWQgc2VydmVyIGVycm9yOlwiLCBlcnIpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiVW5leHBlY3RlZCBzZXJ2ZXIgZXJyb3JcIiB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbInN1cGFiYXNlIiwiZ2V0VG9rZW4iLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInRva2VuIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwic3RhdHVzIiwianNvbiIsInVzZXJJZCIsInN1YiIsInVzZXJfaWQiLCJpZCIsInV1aWRSZWdleCIsInRlc3QiLCJ3YXJuIiwibWV0aG9kIiwiZGF0YSIsImZyb20iLCJzZWxlY3QiLCJlcSIsIm1lc3NhZ2UiLCJhbmltZV9pZCIsImNvbW1lbnQiLCJpbWFnZV91cmwiLCJib2R5IiwiZXhpc3RpbmciLCJmZXRjaEVycm9yIiwibWF5YmVTaW5nbGUiLCJkZXRhaWxzIiwidXBkYXRlIiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImluc2VydCIsImVyciIsImRlbGV0ZSIsInNldEhlYWRlciIsImVuZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/watchlist.js\n");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next-auth/jwt":
/*!********************************!*\
  !*** external "next-auth/jwt" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("next-auth/jwt");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fwatchlist&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cwatchlist.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();